
def genKey(p,q):
    e = 3
    n = p*q;
    phi = (p-1)*(q-1)
    d = pow(e, -1, phi)
    print("p value =",p)
    print("q value =",q)
    print("n value =",n)
    print("phi value =",phi)
    print("e value =",e)
    print("d value =",d)
    return d,e,n
    
def genSignature(msg,d,n):
    sig = (msg ** d % n)
    print("Signature is",sig)
    return sig

def verifySignature(msg,e,sig,n):
    msg_prime = (sig ** e % n)
    if (msg == msg_prime):
        print("Message is valid")
    else: print("invalid message")


msg = 155
d, e, n = genKey(53,47)
signature = genSignature(msg,d,n) 
verifySignature(msg,e,signature,n)       
